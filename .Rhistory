getwd()
setwd("~/Documents/UCD-pbio-rclub/ISLR_Hajar.Amini/Chapter_Dec_13")
knitr::opts_chunk$set(echo = TRUE)
pairs(Auto)
library (MASS)
library (ISLR)
data(Auto)
Auto
pairs(Auto)
Auto$name
cor(subset(Auto, select=-name))
lm.fit = lm(mpg~.-name, data=Auto)
lm.fit
summary(lm.fit)
lm.fit[year]
lm.fit["year"]
lm.fit
library(ISLR)
summary(Carseats)
attach(Carseats)
lm.fit = lm(Sales~Price+Urban+US)
summary(lm.fit)
lm.fit = lm(Sales~Price+Urban+US)
lm.fit
summary(lm.fit1)
lm.fit1 = lm(Sales~Price+Urban+US)
summary(lm.fit1)
lm.fit2 = lm(Sales ~ Price + US)
summary(lm.fit2)
confint(lm.fit2)
lm.fit.all = lm(crim~., data=Boston)
summary(lm.fit.all)
lm.zn = lm(crim~zn)
library(MASS)
summary(Boston)
Boston$chas <- factor(Boston$chas, labels = c("N","Y"))
summary(Boston)
attach(Boston)
lm.zn = lm(crim~zn)
summary(lm.zn) # yes
Boston$chas
lm.zn
lm.zn[2]
Boston$crim
Boston$zn
Boston
coefficients(lm.zn)[2]
coefficients(lm.zn)
lm.fit.all
coefficients(lm.fit.all)[2:14]
x = c(coefficients(lm.zn)[2],
coefficients(lm.indus)[2],
coefficients(lm.chas)[2],
coefficients(lm.nox)[2],
coefficients(lm.rm)[2],
coefficients(lm.age)[2],
coefficients(lm.dis)[2],
coefficients(lm.rad)[2],
coefficients(lm.tax)[2],
coefficients(lm.ptratio)[2],
coefficients(lm.black)[2],
coefficients(lm.lstat)[2],
coefficients(lm.medv)[2])
library(MASS)
summary(Boston)
Boston$chas <- factor(Boston$chas, labels = c("N","Y"))
summary(Boston)
attach(Boston)
lm.zn = lm(crim~zn)
summary(lm.zn) # yes
lm.indus = lm(crim~indus)
summary(lm.indus) # yes
lm.chas = lm(crim~chas)
summary(lm.chas) # no
lm.nox = lm(crim~nox)
summary(lm.nox) # yes
lm.rm = lm(crim~rm)
summary(lm.rm) # yes
lm.age = lm(crim~age)
summary(lm.age) # yes
lm.dis = lm(crim~dis)
summary(lm.dis) # yes
lm.rad = lm(crim~rad)
summary(lm.rad) # yes
lm.tax = lm(crim~tax)
summary(lm.tax) # yes
lm.ptratio = lm(crim~ptratio)
summary(lm.ptratio) # yes
lm.black = lm(crim~black)
summary(lm.black) # yes
lm.lstat = lm(crim~lstat)
summary(lm.lstat) # yes
lm.medv = lm(crim~medv)
summary(lm.medv) # yes
x = c(coefficients(lm.zn)[2],
coefficients(lm.indus)[2],
coefficients(lm.chas)[2],
coefficients(lm.nox)[2],
coefficients(lm.rm)[2],
coefficients(lm.age)[2],
coefficients(lm.dis)[2],
coefficients(lm.rad)[2],
coefficients(lm.tax)[2],
coefficients(lm.ptratio)[2],
coefficients(lm.black)[2],
coefficients(lm.lstat)[2],
coefficients(lm.medv)[2])
y = coefficients(lm.fit.all)[2:14]
plot(x, y)
lm.zn = lm(crim~poly(zn,3))
summary(lm.zn) # 1, 2
lm.indus = lm(crim~poly(indus,3))
summary(lm.indus) # 1, 2, 3
lm.nox = lm(crim~poly(nox,3))
Boston$nox
coefficients(lm.medv)[2]
lm.nox = lm(crim~nox)
summary(lm.nox)
lm.black = lm(crim~poly(black,3))
summary(lm.black)
lm.rad = lm(crim~poly(rad,3))
summary(lm.rad)
lm.indus = lm(crim~poly(indus))
lm.indus
lm.rad = lm(crim~poly(rad,3))
lm.rad
lm.dis = lm(crim~poly(dis,3))
lm.dis
lm.dis = lm(crim~poly(dis,2))
lm.dis
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(markdown)
knitr::opts_chunk$set(echo = TRUE)
library (MASS)
library (ISLR)
data(Auto)
pairs(Auto)
ggpairs(Auto,c[1:7])
library(ggpairs)
library(ggplot2)
ggpairs(Auto,c[1:7])
require(GGally)
install.packages(GGally)
install.packages("GGally")
ggpairs(Auto,c[1:7])
ggpairs(Auto)
install.packages("reshape")
ggpairs(Auto)
ggpairs(Auto,c[1:7])
setwd("~/Documents/UCD-pbio-rclub/ISLR_Hajar.Amini/Chapter3_Dec_20")
knitr::opts_chunk$set(echo = TRUE)
par(mfrow=c(2,2))
plot(lm.fit1)
lm.fit1 = lm(mpg~.-name, data=Auto)
knitr::opts_chunk$set(echo = TRUE)
library (MASS)
library (ISLR)
lm.fit1 = lm(mpg~.-name, data=Auto)
summary(lm.fit1)
par(mfrow=c(2,2))
plot(lm.fit1)
plot(predict(lm.fit1), rstudent(lm.fit1))
plot(predict(lm.fit1)
>
quit
>
data("Auto")
Auto
lm.fit2 = lm(mpg~cylinders*displacement+displacement*weight)
lm.fit2 = lm(mpg~cylinders*displacement+displacement*weight, data = Auto)
lm.fit2
summary(lm.fit2)
lm.fit3 = lm(mpg~log(weight)+sqrt(horsepower)+acceleration+I(acceleration^2))
lm.fit3 = lm(mpg~log(weight)+sqrt(horsepower)+acceleration+I(acceleration^2), data = Auto)
summary(lm.fit3)
par(mfrow=c(2,2))
plot(lm.fit3)
plot(predict(lm.fit3), rstudent(lm.fit3))
plot(lm.fit3)
lm.fit2<-lm(log(mpg)~cylinders+displacement+horsepower+weight+acceleration+year+origin,data=Auto)
summary(lm.fit2)
par(mfrow=c(2,2))
plot(lm.fit2)
plot(predict(lm.fit2),rstudent(lm.fit2))
plot(predict(lm.fit3), rstudent(lm.fit3))
plot(predict(lm.fit2),rstudent(lm.fit2))
lm.fit2 = lm(Sales ~ Price + US)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(markdown)
library (MASS)
library (ISLR)
data(Auto)
pairs(Auto)
lm.fit2 = lm(Sales ~ Price + US)
lm.fit2 = lm(Sales ~ Price + US)
lm.fit2 = lm(sales ~ price + US)
library(MASS)
summary(Boston)
Boston
Auto
library(ISLR)
summary(Carseats)
library(ISLR)
summary(Carseats)
summary(Carseats)
lm.fit2 = lm(sales ~ price + US)
lm.fit2 = lm(Sales ~ Price + US)
lm.fit2 = lm(Sales ~ Price + US, data = Carseats)
summary(lm.fit2)
plot(predict(lm.fit2), rstudent(lm.fit2))
par(mfrow=c(2,2))
plot(lm.fit2)
lm.fit1 = lm(mpg~.-name, data=Auto)
summary(lm.fit1)
par(mfrow=c(2,2))
plot(lm.fit1)
#The fit does not appear to be accurate because there is an obvious curve pattern to the residuals plots. From the leverage plot, point 14 appears to have high leverage, without a high magnitude residual.
plot(predict(lm.fit1), rstudent(lm.fit1))
#There are possible outliers regarding  plot of studentized residuals because there are data with a value greater than 3.
library (MASS)
library (ISLR)
data(Auto)
library (MASS)
library (ISLR)
data(Auto)
lm.fit1 = lm(mpg~.-name, data=Auto)
summary(lm.fit1)
par(mfrow=c(2,2))
plot(lm.fit1)
#The fit does not appear to be accurate because there is an obvious curve pattern to the residuals plots. From the leverage plot, point 14 appears to have high leverage, without a high magnitude residual.
plot(predict(lm.fit1), rstudent(lm.fit1))
#There are possible outliers regarding  plot of studentized residuals because there are data with a value greater than 3.
lm.fit =lm(medv∼lstat+age ,data=Boston )
lm.fit =lm(medv∼lstat+age,data=Boston )
Boston
lm.fit =lm(medv∼lstat+age,data=Boston )
library (MASS)
library (ISLR)
lm.fit =lm(medv∼lstat+age,data=Boston )
lm.fit = lm(medv∼lstat+age,data=Boston )
lm.fit <- lm(data = Boston, medv~lstat+age)
summary(lm.fit)
lm.fit <- lm(medv~. , data=Boston)
summary(lm.fit)
summary(lm.fit)$r.sq
summary(lm.fit)$sigma
library (car)
install.packages(car)
install.packages("car")
library (car)
vif(lm.fit)
lm.fit1=lm(medv∼.-age ,data=Boston )
lm.fit1 >- lm(medv~.-age, data = Boston)
lm.fit1 >- lm(medv~. -age, data = Boston)
lm.fit1=lm(medv~. -age, data = Boston)
lm.fit1=lm(medv~.-age, data = Boston)
summary (lm.fit1)
lm.fit1=update (lm.fit , ∼.-age)
lm.fit1=update(lm.fit , ∼.-age)
lm.fit1=update(lm.fit, ∼.-age)
lm.fit1=update(lm.fit,∼.-age)
update()
lm.fit1=update (lm.fit,∼. -age)
lm.fit1= update (lm.fit,∼. -age)
lm.fit1=update(lm.fit, ~. -age)
lm.fit1
summary (lm(medv∼lstat *age ,data=Boston ))
summary(lm(medv~lstat *age, data = Boston))
lm.fit2=lm(medv∼lstat +I(lstat ^2))
lm.fit2=lm(medv~lstat + I(lstat^2))
lm.fit2=lm (medv~lstat + I(lstat^2))
lm.fit2=lm(medv~ lstat + I(lstat^2))
lm.fit2=lm(medv~lstat +I(lstat^2))
lm.fit2=lm(medv~lstat +I(lstat^2), data = Boston)
summary(lm.fit2)
lm.fit =lm(medv∼lstat, data=Boston)
lm.fit=lm(medv∼lstat, data=Boston)
lm.fit=lm(medv~lstat, data=Boston)
summary(lm.fit)
anova(lm.fit ,lm.fit2)
par(mfrow=c(2,2))
plot(lm.fit2)
lm.fit5=lm(medv∼poly(lstat ,5), data=Boston)
lm.fit5=lm(medv∼poly(lstat,5), data=Boston)
lm.fit5=lm(medv~ploy(lstat, 5), data = Boston)
lm.fit5=lm(medv~ ploy(lstat, 5), data = Boston)
lm.fit5=lm(medv~ poly(lstat, 5), data = Boston)
summary(lm.fit5)
summary (lm(medv∼log(rm),data=Boston ))
summary(lm(medv~log(rm), data = Boston))
fix( Carseats )
?fix
names(Carseats )
lm.fit =lm(Sales∼.+ Income :Advertising +Price :Age ,data=Carseats )
lm.fit=lm(Sales~.+Income:Advertising+Price:Age, data=Carseats)
summary (lm.fit)
attach (Carseats )
contrasts (ShelveLoc )
Carseats$
>
?attach
?contrasts
ShelveLocGood
contrasts (ShelveLoc )
Carseats$ShelveLoc
