{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Chapter3_Dec_13\"\noutput: \n  html_document: \n    keep_md: yes\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n#problems\n1. Describe the null hypotheses to which the p-values given in Table 3.4\ncorrespond. Explain what conclusions you can draw based on these\np-values. Your explanation should be phrased in terms of sales, TV,\nradio, and newspaper, rather than in terms of the coefficients of the\nlinear model.\nIn Table 3.4, the null hypothesis for \"TV\" is that in the presence of radio\nads and newspaper ads, TV ads have no effect on sales. Similarly, the null\nhypothesis for \"radio\" is that in the presence of TV and newspaper ads, radio\nads have no effect on sales. And there is a similar null hypothesis for\n\"newspaper\". \nThe low p-values of TV and radio suggest that the null hypotheses\nare false for TV and radio. The high p-value of newspaper suggests that the null\nhypothesis is true for newspaper\n\n9. This question involves the use of multiple linear regression on the\nAuto data set.\n\n(a) Produce a scatterplot matrix which includes all of the variables\nin the data set.\n```{r}\nlibrary (MASS)\nlibrary (ISLR)\ndata(Auto)\npairs(Auto)\n```\n\n(b) Compute the matrix of correlations between the variables using\nthe function cor(). You will need to exclude the name variable,\ncor()\nwhich is qualitative.\n\n```{r}\ncor(subset(Auto, select=-name))\n```\n\n(c) Use the lm() function to perform a multiple linear regression\nwith mpg as the response and all other variables except name as\nthe predictors. Use the summary() function to print the results.\nComment on the output. For instance:\n\n```{r}\nlm.fit = lm(mpg~.-name, data=Auto)\nsummary(lm.fit)\n```\n\ni. Is there a relationship between the predictors and the response?\n\nYes, there is a relatioship between the predictors and the response by testing the null hypothesis of all the regression coefficients are zero. The F-test is far from 1 (with a small p-value) is evidence for false null hypothesis. \n\nii. Which predictors appear to have a statistically significant\nrelationship to the response?\n\nLooking at the p-values associated with each predictor's t-statistic, we see that displacement, weight, year, and origin have a statistically significant relationship, while cylinders, horsepower, and acceleration do not.\n\niii. What does the coefficient for the year variable suggest?\n\nThe regression coefficient for year, r coefficients(lm.fit)[\"year\"], suggests that for every one year, mpg increases by the coefficient.cars become more fuel efficient every year by almost 1 mpg / year\n\n10. This question should be answered using the Carseats data set.\n\n(a) Fit a multiple regression model to predict Sales using Price,\nUrban, and US.\n\n```{r}\nlibrary(ISLR)\nsummary(Carseats)\nattach(Carseats)\nlm.fit1 = lm(Sales~Price+Urban+US)\nsummary(lm.fit1)\n```\n\n(b) Provide an interpretation of each coefficient in the model. Be\ncareful—some of the variables in the model are qualitative!\n\nPrice: The linear regression suggests a relationship between price and sales given the low p-value of the t-statistic. The coefficient states a negative relationship between Price and \nSales: as Price increases, Sales decreases.\n\nUrbanYes: The linear regression suggests that there isn't a relationship between the location of the store and the number of sales based on the high p-value of the t-statistic.\n\nUSYes:The linear regression suggests there is a relationship between whether the store is in the US or not and the amount of sales. The coefficient states a positive relationship between USYes and Sales: if the store is in the US, the sales will increase by approximately 1201 units.\n\n(c) Write out the model in equation form, being careful to handle\nthe qualitative variables properly.\n\nSales = 13.04 + -0.05 Price + -0.02 UrbanYes + 1.20 USYes\n\n(d) For which of the predictors can you reject the null hypothesis\nH0 : βj = 0?\n\nPrice and USYes, based on the p-values, F-statistic, and p-value of the F-statistic.\n\n(e) On the basis of your response to the previous question, fit a smaller model that only uses the predictors for which there is evidence of association with the outcome.\n\n```{r}\nlm.fit2 = lm(Sales ~ Price + US)\nsummary(lm.fit2)\n```\n\n(f) How well do the models in (a) and (e) fit the data?\n\nBased on the RSE and R^2 of the linear regressions, (e) fitting the data slightly better.\n\n(g) Using the model from (e), obtain 95% confidence intervals for\nthe coefficient(s).\n\n```{r}\nconfint(lm.fit2)\n```\n\n15. This problem involves the Boston data set, which we saw in the lab\nfor this chapter. We will now try to predict per capita crime rate\nusing the other variables in this data set. In other words, per capita\ncrime rate is the response, and the other variables are the predictors.\n\n(a) For each predictor, fit a simple linear regression model to predict\nthe response. Describe your results. In which of the models is\nthere a statistically significant association between the predictor\nand the response? Create some plots to back up your assertions.\n\n```{r}\nlibrary(MASS)\nsummary(Boston)\nBoston$chas <- factor(Boston$chas, labels = c(\"N\",\"Y\"))\nsummary(Boston)\nattach(Boston)\nlm.zn = lm(crim~zn)\nsummary(lm.zn) # yes\nlm.indus = lm(crim~indus)\nsummary(lm.indus) # yes\nlm.chas = lm(crim~chas) \nsummary(lm.chas) # no\nlm.nox = lm(crim~nox)\nsummary(lm.nox) # yes\nlm.rm = lm(crim~rm)\nsummary(lm.rm) # yes\nlm.age = lm(crim~age)\nsummary(lm.age) # yes\nlm.dis = lm(crim~dis)\nsummary(lm.dis) # yes\nlm.rad = lm(crim~rad)\nsummary(lm.rad) # yes\nlm.tax = lm(crim~tax)\nsummary(lm.tax) # yes\nlm.ptratio = lm(crim~ptratio)\nsummary(lm.ptratio) # yes\nlm.black = lm(crim~black)\nsummary(lm.black) # yes\nlm.lstat = lm(crim~lstat)\nsummary(lm.lstat) # yes\nlm.medv = lm(crim~medv)\nsummary(lm.medv) # yes\n```\n\n(b) Fit a multiple regression model to predict the response using\nall of the predictors. Describe your results. For which predictors\ncan we reject the null hypothesis H0 : βj = 0?\n\n```{r}\nlm.fit.all = lm(crim~., data=Boston)\nsummary(lm.fit.all)\n#reject the null hypothesis for zn, dis, rad, black, medv\n```\n\n(c) How do your results from (a) compare to your results from (b)?\nCreate a plot displaying the univariate regression coefficients\nfrom (a) on the x-axis, and the multiple regression coefficients\nfrom (b) on the y-axis. That is, each predictor is displayed as a\nsingle point in the plot. Its coefficient in a simple linear regression\nmodel is shown on the x-axis, and its coefficient estimate\nin the multiple linear regression model is shown on the y-axis.\n\n```{r}\nx = c(coefficients(lm.zn)[2],\n      coefficients(lm.indus)[2],\n      coefficients(lm.chas)[2],\n      coefficients(lm.nox)[2],\n      coefficients(lm.rm)[2],\n      coefficients(lm.age)[2],\n      coefficients(lm.dis)[2],\n      coefficients(lm.rad)[2],\n      coefficients(lm.tax)[2],\n      coefficients(lm.ptratio)[2],\n      coefficients(lm.black)[2],\n      coefficients(lm.lstat)[2],\n      coefficients(lm.medv)[2])\ny = coefficients(lm.fit.all)[2:14]\nplot(x, y)\n\n#Coefficient for nox is approximately -10 in univariate model and 31 in multiple regression model.\n```\n\n(d) Is there evidence of non-linear association between any of the\npredictors and the response? To answer this question, for each\npredictor X, fit a model of the form\nY = β0 + β1X + β2X2 + β3X3 + e.\n\n```{r}\nlm.zn = lm(crim~poly(zn,3))\nsummary(lm.zn) \nlm.indus = lm(crim~poly(indus,3))\nsummary(lm.indus)\n# lm.chas = lm(crim~poly(chas,3)) : qualitative predictor\nlm.nox = lm(crim~poly(nox,3))\nsummary(lm.nox) \nlm.rm = lm(crim~poly(rm,3))\nsummary(lm.rm) \nlm.age = lm(crim~poly(age,3))\nsummary(lm.age) \nlm.dis = lm(crim~poly(dis,3))\nsummary(lm.dis)\nlm.rad = lm(crim~poly(rad,3))\nsummary(lm.rad) \nlm.tax = lm(crim~poly(tax,3))\nsummary(lm.tax)\nlm.ptratio = lm(crim~poly(ptratio,3))\nsummary(lm.ptratio) \nlm.black = lm(crim~poly(black,3))\nsummary(lm.black) \nlm.lstat = lm(crim~poly(lstat,3))\nsummary(lm.lstat) \nlm.medv = lm(crim~poly(medv,3))\nsummary(lm.medv) \n#yes for most, except for black and chas.\n```\n\n",
    "created" : 1513103756904.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "292340513",
    "id" : "BC71204A",
    "lastKnownWriteTime" : 1513137621,
    "last_content_update" : 1513137621120,
    "path" : "~/Documents/UCD-pbio-rclub/ISLR_Hajar.Amini/Chapter3_Dec_13/Chapter3_Dec_13.Rmd",
    "project_path" : "Chapter3_Dec_13/Chapter3_Dec_13.Rmd",
    "properties" : {
        "last_setup_crc32" : "75472C79bb338d19"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}